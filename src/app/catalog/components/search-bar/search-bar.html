<form role="search" aria-labelledby="search-collapse-title" aria-label="Formulario de b√∫squeda y filtros">
  <div class="collapse collapse-arrow bg-neutral/20 shadow-md rounded-lg border border-border">
    <input
      type="checkbox"
      [checked]="isOpen()"
      (change)="toggleOpen()"
      aria-controls="search-collapse-content"
      [attr.aria-expanded]="isOpen()"
      aria-label="Alternar b√∫squeda y filtros"
    />

    <div id="search-collapse-title" class="collapse-title text-lg font-medium flex items-center gap-2" role="heading" aria-level="2">
      üîç Buscar y filtrar
      <span class="badge badge-sm badge-accent text-text" role="status" aria-live="polite"> {{ activeFiltersCount() }} filtros activos </span>
    </div>

    <div id="search-collapse-content" class="collapse-content" [attr.aria-hidden]="!isOpen()">
      <div class="space-y-4 pt-2">
        <div>
          <label class="label" for="search-input">
            <span class="label-text font-medium">Buscar</span>
          </label>
          <input
            id="search-input"
            type="search"
            [value]="searchValue()"
            (input)="onSearchInput($event)"
            placeholder="Nombre o descripci√≥n..."
            class="input input-bordered w-full"
            aria-label="Buscar productos por nombre o descripci√≥n"
            aria-describedby="search-help"
          />
          <p id="search-help" class="sr-only">Busca productos por nombre o descripci√≥n.</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="label" for="category-select">
              <span class="label-text font-medium">Categor√≠a</span>
            </label>
            <select
              id="category-select"
              [value]="categoryValue()"
              (change)="onCategoryChange($event)"
              class="select select-bordered w-full"
              aria-label="Filtrar por categor√≠a"
            >
              <option value="all">Todas</option>
              <option value="rom√°ntico">Rom√°ntico</option>
              <option value="mediterr√°neo">Mediterr√°neo</option>
              <option value="bot√°nico">Bot√°nico</option>
              <option value="silvestre">Silvestre</option>
              <option value="moderno">Moderno</option>
            </select>
          </div>

          <div>
            <label class="label" for="occasion-select">
              <span class="label-text font-medium">Ocasi√≥n</span>
            </label>
            <select
              id="occasion-select"
              [value]="occasionValue()"
              (change)="onOccasionChange($event)"
              class="select select-bordered w-full"
              aria-label="Filtrar por ocasi√≥n"
            >
              <option value="all">Todas</option>
              <option value="amor">Amor</option>
              <option value="cumplea√±os">Cumplea√±os</option>
              <option value="nacimiento">Nacimiento</option>
              <option value="agradecimiento">Agradecimiento</option>
              <option value="p√©same">P√©same</option>
              <option value="celebraci√≥n">Celebraci√≥n</option>
            </select>
          </div>
        </div>

        @if (activeFiltersCount() > 0) {
          <button (click)="onClearFilters()" class="btn btn-ghost btn-sm w-full" aria-label="Limpiar filtros activos">
            ‚úï Limpiar filtros
          </button>
        }
      </div>
    </div>
  </div>
</form>
